{# templates/admin/manage_articles.html #} {% extends "base.html" %} {% block
content %}
<div class="admin-dashboard">
    <div class="page-header">
        <h1>Manage Articles and Newsletters</h1>
    </div>
    <div class="page-section">
        <a href="{{ url_for('admin.create_article') }}" class="button">Create New</a>

        <section class="article-filters">
            <h2>Filter Articles</h2>
            <button class="button active" data-filter="all">All</button>
            <button class="button" data-filter="article">Articles</button>
            <button class="button" data-filter="newsletter">Newsletters</button>
        </section>

        <section class="newsletters-grid">
            {% for article in articles %}
            <div class="article-card" data-type="{{ article.type }}">
                <h2>{{ article.title }}</h2>
                <p>{{ article.type.capitalize() }} by {{ article.named_creator }}</p>
                <p>Posted: {{ article.date_posted.strftime('%Y-%m-%d') }}</p>

                {% if article.file_url %}
                <div class="pdf-preview">
                    <iframe src="{{ url_for('main.serve_newsletter', filename=article.file_url) }}" width="100%"
                        height="300" frameborder="0"></iframe>
                </div>
                <a href="{{ url_for('main.serve_newsletter', filename=article.file_url) }}" target="_blank"
                    class="action-btn view-btn">üëÅÔ∏è</a>
                {% endif %}

                <div class="quick-actions">
                    <a href="{{ url_for('admin.edit_article', article_id=article.id) }}"
                        class="action-btn edit-btn">‚úèÔ∏è</a>
                    <button class="action-btn delete-btn"
                        onclick="confirmDelete({{ article.id }}, '{{ article.type }}')">
                        üóëÔ∏è
                    </button>
                </div>
            </div>
            {% endfor %}
        </section>
    </div>
</div>

<script>
    function confirmDelete(articleId, type) {
        if (confirm(`Are you sure you want to delete this ${type}?`)) {
            window.location.href =
                `{{ url_for('admin.delete_article', article_id=0) }}`.replace(
                    "0",
                    articleId
                );
        }
    }

    // Filter functionality
    document.addEventListener("DOMContentLoaded", function () {
        const filterButtons = document.querySelectorAll(".article-filters .button");
        const articles = document.querySelectorAll(".article-card");

        filterButtons.forEach((button) => {
            button.addEventListener("click", function () {
                const filter = this.getAttribute("data-filter");

                // Update active button
                filterButtons.forEach((btn) => btn.classList.remove("active"));
                this.classList.add("active");

                // Filter articles
                articles.forEach((article) => {
                    if (
                        filter === "all" ||
                        article.getAttribute("data-type") === filter
                    ) {
                        article.style.display = "block";
                    } else {
                        article.style.display = "none";
                    }
                });
            });
        });
    });
</script>
{% endblock %}